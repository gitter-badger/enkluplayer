// export object
module.exports = function() {
	var states = [];
	var current = null;

	return {
		initialize: function(allStates) {
			states = allStates;

			// validate states
			for (var i = 0, len = states.length; i < len; i++) {
				var state = states[i];
				if (!state.id) {
					log.warn("State has no id.");
				}

				if (!state.enter || !state.exit || !state.update) {
					log.warn("State does not have proper lifecycle methods.");
				}
			}
		},

		changeState: function(id) {
			for (var i = 0, len = states.length; i < len; i++) {
				var state = states[i];
				if (state.id === id) {
					if (current === state) {
						return;
					}

					log.debug(
						"Changing state from {0} to {1}.",
						current ? "null" : current.id,
						state ? "null" : state.id);

					if (null !== current) {
						current.exit();
					}

					current = state;

					if (null !== current) {
						current.enter();
					}

					return;
				}
			}
		},

		update: function() {
			if (null !== current) {
				current.update();
			}
		}
	};
};